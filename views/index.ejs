<!DOCTYPE html>
<html lang="en">
<%- include('heade') -%>
<body>

<div class="container ">
<h2 class="mt-3 mb-5 text-center">Shoorty | Url Shortner</h2>


<div class="">

	<form class="d-flex justify-content-center align-items-center" method="POST" action="/short">
		<input required class="m-2 col form-controle py-2" placeholder="Url" type="text" name="full_url">
		<button class="m-2 px-4 pt-2 pb-2 btn btn-lg btn-success"><i class="fas fa-cut"></i></button>
	</form>

<% if (results.length <= 0) { %>
<h2 class="mt-5 mb-5 text-center">Ooops Sorry you didn't make any short urls yet</h2>
<% } else { %>

<center>
	<table class="table table-striped table-responsive ">
	  <thead class="thead-dark table-bordered">
	    <tr>
	      <th scope="col">Full url</th>
	      <th scope="col">Short url</th>
	      <th scope="col">Slug</th>
	      <th scope="col">Clicks</th>
	    </tr>
	  </thead>
	  <tbody class="table-bordered" >
	  	<% results.forEach(result => { %>
		    <tr >
		      <td><a href="<%= result.full_url %>"><%= result.full_url %></a></td>
		      <td><a id="shortUrl" href="/<%= result.slug %>"><%= result.slug %></a></td>
		      <td><a href="/<%= result.slug %>"><%= result.slug %></a></td>
		      <td><%= result.clicks %></td>
		    </tr>
		<% })} %>
	  </tbody>
	</table>
</center>

</div>

</div>


<%- include('footer') -%>
<%- include('bootstrap_scripts') -%>
<script type="text/javascript">
	const domain = window.location.hostname;
	let arr;
	const GetPort = () => {
		arr = window.location.href.split("/");
		return arr[0]+"//"+arr[2]+"/"
	}

	const getTheShortUrl = () => {
		if (domain == "localhost") {
			GetPort()
			let baseURL = `${GetPort()}`;
			return baseURL;
		} else {
			let baseURL = `http://${domain}/`;
			return baseURL;
		}
	}


	let shortUrl = document.querySelectorAll('#shortUrl')
	shortUrl.forEach(e => e.innerText = getTheShortUrl()+e.innerText)
</script>
</body>
</html>